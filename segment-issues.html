<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.14">
<title data-react-helmet="true">Segment Issues | debugvideo.com</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://debugvideo.com/segment-issues"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Segment Issues | debugvideo.com"><meta data-react-helmet="true" name="description" content="Now it&#x27;s time to get deep into the streams. Here we&#x27;re looking at the video content itself, rather than just the manifest."><meta data-react-helmet="true" property="og:description" content="Now it&#x27;s time to get deep into the streams. Here we&#x27;re looking at the video content itself, rather than just the manifest."><link data-react-helmet="true" rel="icon" href="/img/logo.svg"><link data-react-helmet="true" rel="canonical" href="https://debugvideo.com/segment-issues"><link data-react-helmet="true" rel="alternate" href="https://debugvideo.com/segment-issues" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://debugvideo.com/segment-issues" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.488c9a18.css">
<link rel="preload" href="/assets/js/runtime~main.7a504851.js" as="script">
<link rel="preload" href="/assets/js/main.fe081bf2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="debugvideo.com Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.svg" alt="debugvideo.com Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">debugvideo.com</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/gesinger/debugvideo-com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/">What is this?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/who-is-this-for">Who is this for?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/what-will-i-be-able-to-do">What will I be able to do?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/how-is-this-guide-organized">How is this guide organized?</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/short-guide-streaming-video">A short guide to streaming video</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/addressing-new-tickets">Addressing new tickets</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/what-if-you-cant-reproduce">What if you can&#x27;t reproduce?</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link hasHref_TwRn" href="/browser-devtools">Browser developer tools</a><button aria-label="Toggle the collapsible sidebar category &#x27;Browser developer tools&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devtools-console">Console</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devtools-network">Network</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/devtools-media">Media</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--active hasHref_TwRn" href="/stream-issues">Stream issues</a><button aria-label="Toggle the collapsible sidebar category &#x27;Stream issues&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/manifest-issues">Manifest</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/segment-issues">Segment</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/player-issues">Player issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/browser-issues">Browser issues</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/drm">DRM</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist hasHref_TwRn" href="/charles-and-har-files">Other tools</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/charles-and-har-files">Charles Proxy and HAR files</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/exercises">Exercises</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Segment Issues</h1></header><p>Now it&#x27;s time to get deep into the streams. Here we&#x27;re looking at the video content itself, rather than just the manifest.</p><div class="admonition admonition-note alert alert--secondary"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>Downloading Segments</h5></div><div class="admonition-content"><p>To work with segments, you first need to download, and sometimes reconstruct, the segments you want to look into.</p><p>Most of the time, the process is simple. Go to the <a href="/devtools-network">devtools network panel</a>, find the relevant segment, and double click it. If you&#x27;re dealing with range requests though, you may find yourself downloading a much larger file than expected. In this case, in Chrome, right click the segment and go to Copy =&gt; Copy as cURL:</p><p><img alt="Image of option for Copy as cURL" src="/assets/images/copy-as-curl-1153f673b995091101f22d89b61271da.png"></p><p>After that, paste it into a terminal, and add an output with the segment name and extension:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">pasted </span><span class="token function" style="color:#d73a49">curl</span><span class="token plain"> command</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> --output </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">some-segment-name</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">.</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">ts</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">mp4</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">m4f</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">etc</span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>This will ensure you download only the byterange you&#x27;re looking for, rather than the whole file.</p><p>Some segments require the prepending of an initialization segment for some tools to read it (e.g., ffprobe). An initialization segment is a segment that provides media metadata, and is often shared between many different segments. To retrieve the initialization segments:</p><p><strong>HLS</strong>: Look for the segment&#x27;s closest preceding <a href="https://datatracker.ietf.org/doc/html/draft-pantos-hls-rfc8216bis-10#section-4.4.4.5" target="_blank" rel="noopener noreferrer">EXT-X-MAP</a> tag. If you can&#x27;t find one, the segment is self initializing.</p><p><strong>DASH</strong>: For <code>SegmentBase</code>, <code>SegmentList</code>, and <code>SegmentTemplate</code> elements, check for an <code>&lt;Initialization&gt;</code> element. For <code>SegmentTemplate</code>, also check for an <code>initialization</code> property. If none exist, segments are self initializing.</p><p>Once you&#x27;ve downloaded the initialization segment, and the segment you&#x27;re looking to work with, concatenate them together:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">cat</span><span class="token plain"> init-segment.mp4 segment3.mp4 </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> segment3-with-init.mp4</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>Then you can use <code>ffprobe</code> and other utilities on <code>segment3-with-init.mp4</code>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="playing-a-segment-independently">Playing a segment independently<a class="hash-link" href="#playing-a-segment-independently" title="Direct link to heading">â€‹</a></h2><p>Often, problems occur when playback reaches a specific segment. Once you&#x27;ve downloaded it, try to play it in a desktop video player (e.g., QuickTime or VLC). <em>Note</em>: VLC is robust enough to successfully interpret and play video if run on a slice of toast, so successful playback in VLC doesn&#x27;t necessarily mean the segment is perfectly valid.</p><p>If the segment plays without issue, try playing it in a browser&#x27;s video element directly. If it&#x27;s an MP4, create a <code>&lt;video&gt;</code> tag on the page and use the segment as the <code>&lt;source&gt;</code>. If it&#x27;s a TS, try creating a very basic HLS VOD playlist with that single segment, and run it through the video player you&#x27;re using. For instance:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#EXTM3U</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-VERSION:3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-PLAYLIST-TYPE:VOD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-TARGETDURATION:10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXTINF:10,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">some-segment.ts</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#EXT-X-ENDLIST</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Try it yourself</h5></div><div class="admonition-content"><p>Try to make a single segment VOD HLS manifest and play it back in a browser&#x27;s video player. If you need a segment, you can take an MP4 and convert it to TS while preserving the codecs via ffmpeg:</p><div class="codeBlockContainer_J+bg language-bash theme-code-block"><div class="codeBlockContent_csEI bash"><pre tabindex="0" class="prism-code language-bash codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">ffmpeg -i some-mp4.mp4 -c copy some-segment.ts</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p>To serve the segment and manifest, you&#x27;ll have to run a local server. Some popular local servers are <a href="https://github.com/http-party/http-server" target="_blank" rel="noopener noreferrer">http-server</a> and Python&#x27;s <code>SimpleHTTPServer</code>.</p></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="ffprobe">ffprobe<a class="hash-link" href="#ffprobe" title="Direct link to heading">â€‹</a></h2><p><code>ffprobe</code> is an incredibly handy tool when debugging segments. It can be run on locally downloaded segments or on segment URLs. There are a few key commands to use with ffprobe.</p><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ffprobe-segment">ffprobe <!-- -->[segment]<a class="hash-link" href="#ffprobe-segment" title="Direct link to heading">â€‹</a></h3><p>Running <code>ffprobe</code> alone, with no options, provides a high level view of the segment. It includes the duration, start time, bitrate, and a list of programs. Within each program you&#x27;ll see streams. If the streams are muxed, then in one segment you will see at least two streams, one for audio, and one for video, with each listing the stream ID, codecs, and profiles. In addition, you may see metadata streams, e.g., ID3 streams.</p><p>A basic <code>ffprobe</code> of a segment can highlight a few issues:</p><ul><li><strong>Mismatching stream IDs</strong>: If you are comparing the <code>ffprobe</code> results of two segments without a discontinuity between them, it can be important to check that the stream IDs remain consistent, otherwise, MEDIA<!-- -->_<!-- -->ERR<!-- -->_<!-- -->DECODE or other similar errors may be thrown.</li><li><strong>Missing audio/video</strong>: If the stream is muxed, and you only notice a segment containing one stream (either audio or video, but not both), then there may be gaps in the stream. One case where this happens is when there are segments with no audio, and the encoder doesn&#x27;t include the audio stream for those segments. This is against spec, and must be fixed by the encoder.</li><li><strong>Wrong or mismatched codecs</strong>: If the manifest advertises that a stream has one type of codec, and a single segment has a codec that isn&#x27;t compatible with the advertised one, then the browser may throw a MEDIA<!-- -->_<!-- -->ERR<!-- -->_<!-- -->DECODE.</li><li><strong>Too many streams for a given media</strong>: Segments may have multiple programs, and multiple streams of each type (e.g., a segment may have one video stream and two audio streams, to provide audio for two languages). This is common for closed captions and metadata. However, this is not common for video on the web, as it wastes bandwidth and processing resources. HLS and DASH provide ways to signal alternate media streams in the manifest, so players need only download the track being used. Many browser-based players are unable to handle multiple audio and video streams in the same segment. If you notice multiple in a segment, check with the stream provider to see if they can split the extra streams into separate manifest signaled renditions.</li></ul><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Try it yourself</h5></div><div class="admonition-content"><p>Find any segment you have downloaded (or a URL to one) and run <code>ffprobe [segment]</code>.</p><ul><li>Can you determine if the content is muxed?</li><li>Is there a metadata stream?</li><li>What is the codec and profile of each stream?</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ffprobe--show_streams-segment">ffprobe -show_streams <!-- -->[segment]<a class="hash-link" href="#ffprobe--show_streams-segment" title="Direct link to heading">â€‹</a></h3><p>One of the most important pieces of information <code>-show_streams</code> surfaces is timing information: the start times and durations of each stream.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>PTS and DTS Times in Segments</h5></div><div class="admonition-content"><p>Timing information in segments is relative to the program&#x27;s clock. When looking at timestamps for segments and frames, there are two times you&#x27;ll see:</p><ul><li><strong>Presentation Timestamp (PTS)</strong>: The program clock time at which a frame should be shown (or, in the case of a segment, generally the earliest frame&#x27;s PTS).</li><li><strong>Decode Timestamp (DTS)</strong>: The program clock time at which a frame should be decoded. This is important for frames which are referenced by other frames.</li></ul><p>In addition, <code>-show_streams</code> will show the <code>time_base</code>. For many video streams, it&#x27;s a 90kHz clock, meaning in the <code>ffprobe -show_streams</code> results you will see:</p><div class="codeBlockContainer_J+bg theme-code-block"><div class="codeBlockContent_csEI"><pre tabindex="0" class="prism-code language-undefined codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">time_base=1/90000</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><code>time_base</code> allows you to convert between program clock time to seconds, and vice versa. So if a segment has a <code>start_pts</code> of 900,000, and a <code>time_base</code> of 1/90,000, then you can get the <code>start_time</code> in seconds by dividing 900,000 by 90,000, resulting in a <code>start_time</code> of 10 seconds.</p></div></div><p>What to check for in <code>-show_streams</code>:</p><ul><li><strong>Timing Mismatch Between Audio and Video</strong>: If the segment is muxed, and the audio and video timing values are mismatched, that <em>may</em> indicate a problem, or at least provides an avenue of exploration. Streams within a segment <em>usually</em> have relatively consistent timing values, maybe off by a few frames, up to a few seconds. If they are more offset than that, then it could be a reason for playback problems. If the segment is the first in a stream, and there are differing offsets, it may mean that, depending on the player&#x27;s configuration, some audio or video may be cut off, or there&#x27;s a gap at the start of playback.</li><li><strong>Gaps Between Segments</strong>: When comparing multiple segments, check to see that their start times and end times between streams line up without gaps (add the <code>start_time</code> and <code>duration</code> values to get end times).</li></ul><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Try it Yourself</h5></div><div class="admonition-content"><p>Find any segment you have downloaded (or a URL to one) and run <code>ffprobe -show_streams [segment]</code>.</p><ul><li>What is the time base?</li><li>What is the start time and end time of the segment?</li><li>If this segment is muxed, how far apart are audio and video streams?</li><li>Try running ffprobe on two consecutive segments, do the audio and video stream timings line up?</li><li>What&#x27;s the clock duration of a frame for each stream? What&#x27;s the duration in seconds?</li><li>If this is the first segment in a manifest, do the streams both start at 0? If not, do they start at the same time?</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_y2LR" id="ffprobe--show_frames-segment">ffprobe -show_frames <!-- -->[segment]<a class="hash-link" href="#ffprobe--show_frames-segment" title="Direct link to heading">â€‹</a></h3><p>When you don&#x27;t see any issues with <code>-show_streams</code> and want to dig deeper into the segment, it&#x27;s time to run <code>-show_frames</code>. <code>-show_frames</code> will show information for each frame in the segment. Although this can often be overboard, there are a few pieces of information in <code>-show_frames</code> that may be particularly useful:</p><ul><li><strong>(for video) key_frame</strong>: If <code>key_frame</code> is 1, then it&#x27;s a key frame, otherwise it&#x27;s not. If you don&#x27;t see any <code>key_frames</code> in a stream, then there may be playback issues. It&#x27;s also common, but not entirely necessary, for the first frame of the first segment in a VOD manifest to be a key frame.</li><li><strong>PTS gaps</strong>: If you look at the first few and last few frames of the audio and video streams, check for gaps in PTS times between frames (within the same media type). The PTS times should be consistently one frame in duration. Occasionally, there are large gaps between the second to last and last frame of each media type, leading to gaps in playback that aren&#x27;t visible when looking at stream info alone.</li></ul><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>Try it Yourself</h5></div><div class="admonition-content"><p>Find any segment you have downloaded (or a URL to one) and run <code>ffprobe -show_frames [segment]</code>.</p><ul><li>Does the video start with a key frame (note that you&#x27;ll have to find the video frame with the earliest time values, which is sometimes, but not always, the first listed frame)?</li><li>Do the first two and last two frames within each media type have durations of a single frame?</li></ul></div></div><h2 class="anchor anchorWithStickyNavbar_y2LR" id="thumbcoil">thumb.co.il<a class="hash-link" href="#thumbcoil" title="Direct link to heading">â€‹</a></h2><p>A browser-based video inspector that accepts MP4, FLV, or TS files (at <a href="http://thumb.co.il" target="_blank" rel="noopener noreferrer">thumb.co.il</a>), or HLS manifests and TS files with a different UI (at <a href="http://beta.thumb.co.il" target="_blank" rel="noopener noreferrer">beta.thumb.co.il</a>).</p><p>Many of the command line tools provide similar functionality, but beta.thumb.co.il provides manifest navigation UI and shows a graphic of the GOP structure of each segment.</p><p><img alt="Image of GOP structure of a segment from beta.thumb.co.il" src="/assets/images/thumbcoil-gop-structure-16e1d4ea63356fe5640decd36e237225.png"></p><p>In addition, beta.thumb.co.il will provide some quick tests for segment validity, reporting errors and warnings, e.g., a warning if the segment doesn&#x27;t start with an I-frame (which may not be an issue, but as mentioned previously, can be a useful diagnostic tool).</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="xxd">xxd<a class="hash-link" href="#xxd" title="Direct link to heading">â€‹</a></h2><p><code>xxd</code> is a great tool for viewing hexdumps of segments. Why would you want to do this? To feel like you&#x27;re in the matrix, of course.</p><p><img alt="Image of TS xxd hexdump" src="/assets/images/xxd-hexdump-ts-872555904ffe390d0cacb6151098139d.png"></p><p>When you start to learn the bitstream of different container formats (e.g., TS and MP4), you start to appreciate viewing hexdumps. You can see certain patterns. For instance, in TS streams, the stream is cut up into 188 byte packets starting with the sync byte (0x47, ASCII &#x27;G&#x27;). In the above image you can see those sync bytes, and start to make some sense of what&#x27;s going on. For MP4 files the hexdump is even better, as it shows a quick view of the different MP4 boxes, e.g., the &quot;ftyp&quot; box is the first box of the hexdump shown below.</p><p><img alt="Image of MP4 xxd hexdump" src="/assets/images/xxd-hexdump-mp4-68170960b6ec7bbec1d23e43930d0612.png"></p><p>As an example of how this is useful, if the MP4 file above complies with the <a href="https://www.w3.org/TR/mse-byte-stream-format-isobmff" target="_blank" rel="noopener noreferrer">ISO Base Media File Format</a> specification, then the presence of the &quot;ftyp&quot; box tells us it&#x27;s either an init segment or has an init segment prepending it (see <a href="https://www.w3.org/TR/mse-byte-stream-format-isobmff/#iso-init-segments" target="_blank" rel="noopener noreferrer">the Initialization Segment Section</a>).</p><h2 class="anchor anchorWithStickyNavbar_y2LR" id="other-tools">Other Tools<a class="hash-link" href="#other-tools" title="Direct link to heading">â€‹</a></h2><p>There are some other fantastic tools out there which you may find useful, but this guide will not discuss them in detail. Here are a couple that are worth checking out:</p><ul><li><a href="https://github.com/axiomatic-systems/Bento4" target="_blank" rel="noopener noreferrer">Bento4</a>: A suite of tools, with some useful MP4 probing command line programs such as <code>mp4info</code> (well organized and high level MP4 info) and <code>mp4dump</code> (useful for viewing MP4 boxes).</li><li><a href="https://github.com/MediaArea/MediaInfo" target="_blank" rel="noopener noreferrer">mediainfo</a>: Another tool for viewing high level media info. Covers MP4, TS, and more.</li></ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/manifest-issues"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Manifest Issues</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/player-issues"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Player Issues</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#playing-a-segment-independently" class="table-of-contents__link toc-highlight">Playing a segment independently</a></li><li><a href="#ffprobe" class="table-of-contents__link toc-highlight">ffprobe</a><ul><li><a href="#ffprobe-segment" class="table-of-contents__link toc-highlight">ffprobe segment</a></li><li><a href="#ffprobe--show_streams-segment" class="table-of-contents__link toc-highlight">ffprobe -show_streams segment</a></li><li><a href="#ffprobe--show_frames-segment" class="table-of-contents__link toc-highlight">ffprobe -show_frames segment</a></li></ul></li><li><a href="#thumbcoil" class="table-of-contents__link toc-highlight">thumb.co.il</a></li><li><a href="#xxd" class="table-of-contents__link toc-highlight">xxd</a></li><li><a href="#other-tools" class="table-of-contents__link toc-highlight">Other Tools</a></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.7a504851.js"></script>
<script src="/assets/js/main.fe081bf2.js"></script>
</body>
</html>